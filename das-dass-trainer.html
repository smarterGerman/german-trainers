<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>German das/dass Trainer</title>
  <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üìù</text></svg>">
  <style>
    body {
      background: #FFCCE0 !important;
      color: #2C2C2C !important;
      margin: 0;
      padding: 20px;
      min-height: 100vh;
    }

    .sg-unified-container {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
      background: #FAFAFA;
      color: #2C2C2C;
      border-radius: 22px;
      padding: 35px;
      max-width: 900px;
      margin: 10px auto;
      line-height: 1.6;
      box-shadow: 0 8px 30px rgba(233, 30, 99, 0.25);
      border: 3px solid #FFA8CC;
    }

    .sg-dark-title {
      font-size: 36px;
      font-weight: 800;
      background: linear-gradient(135deg, #E91E63, #9C27B0);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      margin-bottom: 12px;
      text-align: center;
    }


    .header-row {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 15px;
    }

    .header-btns {
      display: flex;
      gap: 8px;
    }

    .small-btn {
      background: linear-gradient(135deg, #E91E63, #9C27B0);
      color: white;
      border: none;
      padding: 6px 14px;
      border-radius: 15px;
      font-size: 12px;
      font-weight: 600;
      cursor: pointer;
    }

    .small-btn:hover { opacity: 0.9; }

    .back-btn {
      background: #666;
      color: white;
      border: none;
      padding: 6px 14px;
      border-radius: 15px;
      font-size: 12px;
      font-weight: 600;
      cursor: pointer;
      text-decoration: none;
      display: inline-block;
    }

    .back-btn:hover { background: #555; }

    .info-section {
      background: #FFF8E7;
      padding: 20px;
      border-radius: 8px;
      margin-bottom: 20px;
      font-size: 14px;
      line-height: 1.5;
    }

    .sg-dasdass-highlight-das {
      background: #00BCD4;
      color: white;
      padding: 2px 6px;
      border-radius: 3px;
      font-weight: 600;
    }
    .sg-dasdass-highlight-dass {
      background: #E91E63;
      color: white;
      padding: 2px 6px;
      border-radius: 3px;
      font-weight: 600;
    }
    .sg-dasdass-highlight-welches {
      background: #4CAF50;
      color: white;
      padding: 2px 6px;
      border-radius: 3px;
      font-weight: 600;
    }
    .sg-dasdass-arrow {
      color: #999;
    }

    .sg-dasdass-definitions {
      background: white;
      border-radius: 8px;
      padding: 12px 16px;
      margin-bottom: 12px;
    }
    .sg-dasdass-def-row {
      padding: 8px 0;
      font-size: 14px;
    }
    .sg-dasdass-def-row:first-child {
      border-bottom: 1px solid #eee;
    }
    .sg-dasdass-def-main {
      display: flex;
      align-items: center;
    }
    .sg-dasdass-def-word {
      font-weight: 700;
      font-size: 18px;
      width: 50px;
    }
    .sg-dasdass-def-word.sg-cyan { color: #00BCD4; }
    .sg-dasdass-def-word.sg-pink { color: #E91E63; }
    .sg-dasdass-def-type {
      color: #888;
      font-size: 12px;
      width: 160px;
    }
    .sg-dasdass-def-desc {
      color: #888;
    }
    .sg-dasdass-def-example-sep {
      color: #bbb;
      margin: 0 6px;
    }
    .sg-dasdass-das-italic {
      font-style: italic;
    }

    .sg-dasdass-tricks {
      background: #FFC519;
      border-radius: 6px;
      padding: 12px 16px;
      font-size: 14px;
      margin-bottom: 12px;
      color: #333;
    }
    .sg-dasdass-trick-row {
      margin-bottom: 8px;
    }
    .sg-dasdass-trick-row:last-child {
      margin-bottom: 0;
    }

    .sg-dasdass-examples {
      background: white;
      border-radius: 8px;
      padding: 4px 16px;
    }
    .sg-dasdass-example {
      display: flex;
      align-items: flex-start;
      padding: 10px 0;
      border-bottom: 1px solid #eee;
      font-size: 14px;
    }
    .sg-dasdass-example:last-child {
      border-bottom: none;
    }
    .sg-dasdass-example-icon {
      width: 24px;
      height: 24px;
      border-radius: 50%;
      background: #4CAF50;
      color: white;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: bold;
      font-size: 12px;
      margin-right: 12px;
      flex-shrink: 0;
      margin-top: 2px;
    }
    .sg-dasdass-example-content {
      flex: 1;
    }
    .sg-dasdass-example-german {
      margin-bottom: 3px;
      color: #333;
    }
    .sg-dasdass-example-hint {
      color: #888;
      font-size: 12px;
      margin-left: 8px;
    }
    .sg-dasdass-example-translation {
      color: #999;
      font-size: 12px;
      font-style: italic;
    }

    .sg-dasdass-footer {
      margin-top: 16px;
      padding-top: 12px;
      border-top: 1px solid rgba(0,0,0,0.1);
      font-size: 12px;
      color: #888;
      text-align: center;
    }

    .shortcuts-section {
      background: #F5F5F5;
      padding: 10px 15px;
      border-radius: 8px;
      margin-bottom: 20px;
      font-size: 12px;
      color: #666;
    }

    .shortcuts-section kbd {
      background: white;
      border: 1px solid #DDD;
      border-radius: 3px;
      padding: 2px 6px;
      font-family: monospace;
      margin: 0 2px;
    }

    .key-hint {
      font-size: 12px;
      opacity: 0.5;
      display: block;
      margin-top: 2px;
    }

    .trainer-section {
      margin-top: 30px;
    }

    .progress-info {
      display: flex;
      justify-content: space-between;
      margin-bottom: 15px;
      font-size: 16px;
      font-weight: 600;
    }

    .progress-current {
      color: #6B4E8C;
    }

    .progress-stats {
      display: flex;
      gap: 20px;
    }

    .progress-mastered {
      color: #4CAF50;
    }

    .progress-bar-container {
      height: 14px;
      background: #E0E0E0;
      border-radius: 12px;
      overflow: hidden;
      margin-bottom: 30px;
      box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.1);
    }

    .progress-bar {
      height: 100%;
      background: linear-gradient(90deg, #00BCD4, #00ACC1);
      transition: width 0.3s ease;
      border-radius: 12px;
    }

    .question-area {
      background: white;
      padding: 35px;
      border-radius: 18px;
      text-align: center;
      box-shadow: 0 4px 15px rgba(0, 0, 0, 0.08);
      margin-bottom: 25px;
    }

    .sentence-display {
      font-size: 24px;
      font-weight: 600;
      color: #2C2C2C;
      margin-bottom: 20px;
      line-height: 1.5;
    }

    .blank {
      display: inline-block;
      min-width: 80px;
      margin: 0 5px;
      color: #E91E63;
      font-weight: 800;
    }


    .button-grid {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 15px;
      max-width: 400px;
      margin: 0 auto 25px;
    }

    .answer-btn {
      background: white;
      border: 3px solid #E0E0E0;
      padding: 20px;
      border-radius: 18px;
      font-size: 24px;
      font-weight: 800;
      cursor: pointer;
      transition: all 0.2s;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
      position: relative;
    }

    .answer-btn:hover:not(:disabled) {
      transform: translateY(-3px);
      box-shadow: 0 6px 18px rgba(0, 0, 0, 0.12);
      border-color: #9C27B0;
    }

    .answer-btn.das-btn {
      color: #00BCD4;
    }

    .answer-btn.dass-btn {
      color: #E91E63;
    }

    .answer-btn:disabled {
      cursor: not-allowed;
      opacity: 0.7;
    }

    .answer-btn.correct {
      background: linear-gradient(135deg, #4CAF50, #45A049);
      color: white;
      border-color: #4CAF50;
      animation: pulse 0.5s;
    }

    .answer-btn.wrong {
      background: linear-gradient(135deg, #F44336, #E53935);
      color: white;
      border-color: #F44336;
      animation: shake 0.5s;
    }

    @keyframes pulse {
      0%, 100% { transform: scale(1); }
      50% { transform: scale(1.05); }
    }

    @keyframes shake {
      0%, 100% { transform: translateX(0); }
      25% { transform: translateX(-10px); }
      75% { transform: translateX(10px); }
    }



    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(-10px); }
      to { opacity: 1; transform: translateY(0); }
    }

    .hidden {
      display: none !important;
    }

    .results {
      text-align: center;
      padding: 40px;
      background: white;
      border-radius: 18px;
      box-shadow: 0 6px 20px rgba(0, 0, 0, 0.1);
    }

    .results h2 {
      font-size: 32px;
      color: #E91E63;
      margin-bottom: 25px;
      font-weight: 800;
    }

    .percentage {
      font-size: 72px;
      font-weight: 900;
      background: linear-gradient(135deg, #E91E63, #9C27B0);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      margin-bottom: 20px;
    }

    .result-text {
      font-size: 20px;
      color: #6B4E8C;
      margin-bottom: 30px;
      font-weight: 600;
    }

    .restart-btn {
      background: linear-gradient(135deg, #00BCD4, #00ACC1);
      color: white;
      border: none;
      padding: 18px 40px;
      border-radius: 25px;
      font-size: 18px;
      font-weight: 700;
      cursor: pointer;
      transition: all 0.2s;
      box-shadow: 0 4px 15px rgba(0, 188, 212, 0.4);
      margin: 5px;
    }

    .restart-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(0, 188, 212, 0.5);
    }

    .restart-btn.secondary {
      background: linear-gradient(135deg, #9C27B0, #7B1FA2);
      box-shadow: 0 4px 15px rgba(156, 39, 176, 0.4);
    }

    .restart-btn.secondary:hover {
      box-shadow: 0 6px 20px rgba(156, 39, 176, 0.5);
    }
    /* Light Mode - Warm Cream + Teal */
    body.light-mode {
      background: #F5F3EF;
    }

    body.light-mode .container {
      background: #FFFDF9;
      color: #2D3142;
      border-color: #E2DED6;
      box-shadow: 0 4px 20px rgba(45, 49, 66, 0.08);
    }

    body.light-mode .title {
      background: linear-gradient(135deg, #2E7D6E, #1B5E50);
      -webkit-background-clip: text;
      background-clip: text;
    }

    body.light-mode .info-section {
      background: #F9F7F3;
      border-left-color: #2E7D6E;
      color: #4A4E5A;
    }

    body.light-mode .info-section strong {
      color: #2E7D6E;
    }

    body.light-mode .shortcuts-section {
      background: #F9F7F3;
      color: #6B6F7B;
    }

    body.light-mode .shortcuts-section kbd {
      background: #FFFDF9;
      border-color: #E2DED6;
      color: #2D3142;
    }

    body.light-mode .question-area {
      background: #FFFDF9;
      box-shadow: 0 2px 12px rgba(45, 49, 66, 0.06);
    }

    body.light-mode .word-display {
      color: #2D3142;
    }

    body.light-mode .word-display .blank {
      color: #2E7D6E;
    }

    body.light-mode .translation {
      color: #6B6F7B;
    }

    body.light-mode .progress-bar-wrap {
      background: #E8E6E1;
    }

    body.light-mode .progress-current {
      color: #2E7D6E;
    }

    body.light-mode .progress-mastered {
      color: #1B5E50;
    }

    body.light-mode .choice-btn {
      background: #FFFDF9;
      color: #2D3142;
      border-color: #E2DED6;
    }

    body.light-mode .choice-btn:hover:not(:disabled) {
      background: #E8F4F0;
      border-color: #2E7D6E;
    }

    body.light-mode .results {
      background: #FFFDF9;
      box-shadow: 0 4px 15px rgba(45, 49, 66, 0.08);
    }

    body.light-mode .results h2 {
      color: #2E7D6E;
    }

    body.light-mode .percentage {
      background: linear-gradient(135deg, #2E7D6E, #1B5E50);
      -webkit-background-clip: text;
      background-clip: text;
    }

    body.light-mode .result-text {
      color: #6B6F7B;
    }

    body.light-mode .incorrect-list {
      background: #F9F7F3;
    }

    body.light-mode .incorrect-list h3 {
      color: #C75B7A;
    }

    body.light-mode .incorrect-item {
      border-bottom-color: #E2DED6;
    }

    body.light-mode .back-btn {
      background: #E8E6E1;
      color: #2D3142;
    }

    body.light-mode .back-btn:hover {
      background: #DDD9D2;
    }

    body.light-mode .small-btn {
      background: linear-gradient(135deg, #2E7D6E, #1B5E50);
    }



    /* Dark Mode */
    body.dark-mode {
      background: #1a1a2e;
    }

    body.dark-mode .container {
      background: #16213e;
      color: #e8e8e8;
      border-color: #4a4a6a;
      box-shadow: 0 6px 25px rgba(0, 0, 0, 0.4);
    }

    body.dark-mode .info-section {
      background: #1f2940;
      border-left-color: #FF9800;
      color: #ccc;
    }

    body.dark-mode .shortcuts-section {
      background: #1f2940;
      color: #aaa;
    }

    body.dark-mode .shortcuts-section kbd {
      background: #2a3550;
      border-color: #4a4a6a;
      color: #ddd;
    }

    body.dark-mode .question-area {
      background: #1f2940;
      box-shadow: 0 3px 12px rgba(0, 0, 0, 0.3);
    }

    body.dark-mode .word-display {
      color: #e8e8e8;
    }

    body.dark-mode .progress-bar-wrap {
      background: #2a3550;
    }

    body.dark-mode .choice-btn {
      background: #2a3550;
      color: #e8e8e8;
      border-color: #4a4a6a;
    }

    body.dark-mode .choice-btn:hover {
      background: #3a4560;
      border-color: #6a6a8a;
    }

    body.dark-mode .result-area {
      background: #1f2940;
    }

    body.dark-mode .result-item {
      border-bottom-color: #3a4560;
    }

    body.dark-mode .back-btn {
      background: #3a4560;
    }

    body.dark-mode .back-btn:hover {
      background: #4a5570;
    }
  </style>
</head>
<body>
  <script>
    // Apply theme from hub preference immediately
    const theme = localStorage.getItem('gst_theme');
    if (theme === 'dark') {
      document.body.classList.add('dark-mode');
    } else if (theme === 'light') {
      document.body.classList.add('light-mode');
    }
  </script>
  <div class="sg-unified-container">
    <div class="header-row">
      <a href="index.html" class="back-btn">Dashboard</a>
      <h1 class="sg-dark-title">das oder dass?</h1>
      <div class="header-btns">
        <button class="small-btn" onclick="toggleShortcuts()" id="shortcutsBtn"><u>K</u>eys</button>
        <button class="small-btn" onclick="toggleInfo()" id="toggleBtn"><u>I</u>nfo</button>
      </div>
    </div>

    <div id="shortcutsSection" class="shortcuts-section hidden">
      <kbd>F</kbd> das &nbsp;
      <kbd>J</kbd> dass
    </div>

    <div id="infoSection" class="info-section hidden">
      <div class="sg-dasdass-definitions">
        <div class="sg-dasdass-def-row">
          <div class="sg-dasdass-def-main">
            <div class="sg-dasdass-def-word sg-cyan">das</div>
            <div class="sg-dasdass-def-type">article / relative pronoun</div>
            <div class="sg-dasdass-def-desc">das Buch <span class="sg-dasdass-def-example-sep">|</span> <span class="sg-dasdass-das-italic">das</span> Buch, <span class="sg-dasdass-das-italic">das</span> ich lese</div>
          </div>
        </div>
        <div class="sg-dasdass-def-row">
          <div class="sg-dasdass-def-main">
            <div class="sg-dasdass-def-word sg-pink">dass</div>
            <div class="sg-dasdass-def-type">conjunction</div>
            <div class="sg-dasdass-def-desc">after: sagen, wissen, glauben, denken, hoffen, finden, "es ist..."</div>
          </div>
        </div>
      </div>

      <div class="sg-dasdass-tricks">
        <div class="sg-dasdass-trick-row">Can you replace it with <span class="sg-dasdass-highlight-welches">welches</span> (which)? <span class="sg-dasdass-arrow">&rarr;</span> Use <span class="sg-dasdass-highlight-das">das</span>. Can't? <span class="sg-dasdass-arrow">&rarr;</span> Use <span class="sg-dasdass-highlight-dass">dass</span>.</div>
        <div class="sg-dasdass-trick-row">Is there a noun within 1-2 words after the blank? <span class="sg-dasdass-arrow">&rarr;</span> <span class="sg-dasdass-highlight-das">das</span></div>
      </div>

      <div class="sg-dasdass-examples">
        <div class="sg-dasdass-example">
          <div class="sg-dasdass-example-icon">&#10003;</div>
          <div class="sg-dasdass-example-content">
            <div class="sg-dasdass-example-german">Ich lese <span class="sg-dasdass-highlight-das">das</span> Buch. <span class="sg-dasdass-example-hint"><span class="sg-dasdass-arrow">&rarr;</span> noun follows</span></div>
            <div class="sg-dasdass-example-translation">I'm reading the book.</div>
          </div>
        </div>
        <div class="sg-dasdass-example">
          <div class="sg-dasdass-example-icon">&#10003;</div>
          <div class="sg-dasdass-example-content">
            <div class="sg-dasdass-example-german">Das Buch, <span class="sg-dasdass-highlight-das">das</span> ich lese... <span class="sg-dasdass-example-hint"><span class="sg-dasdass-arrow">&rarr;</span> <span class="sg-dasdass-highlight-welches">welches</span> works</span></div>
            <div class="sg-dasdass-example-translation">The book that/which I read...</div>
          </div>
        </div>
        <div class="sg-dasdass-example">
          <div class="sg-dasdass-example-icon">&#10003;</div>
          <div class="sg-dasdass-example-content">
            <div class="sg-dasdass-example-german">Ich wei√ü, <span class="sg-dasdass-highlight-dass">dass</span> du recht hast. <span class="sg-dasdass-example-hint"><span class="sg-dasdass-arrow">&rarr;</span> <span style="text-decoration: line-through; color: #bbb;">welches</span> nope</span></div>
            <div class="sg-dasdass-example-translation">I know that you're right.</div>
          </div>
        </div>
        <div class="sg-dasdass-example">
          <div class="sg-dasdass-example-icon">&#10003;</div>
          <div class="sg-dasdass-example-content">
            <div class="sg-dasdass-example-german">Es ist wichtig, <span class="sg-dasdass-highlight-dass">dass</span> du kommst. <span class="sg-dasdass-example-hint"><span class="sg-dasdass-arrow">&rarr;</span> after "es ist..."</span></div>
            <div class="sg-dasdass-example-translation">It's important that you come.</div>
          </div>
        </div>
      </div>

      <div class="sg-dasdass-footer">100 sentences, 20 per session. Progress saved locally.</div>
    </div>

    <div class="trainer-section">
      <div id="exerciseArea">
        <div class="progress-info">
          <span class="progress-current">Question <span id="currentNum">1</span>/20</span>
          <div class="progress-stats">
            <span class="progress-mastered">Mastered: <span id="masteredCount">0</span>/100</span>
          </div>
        </div>
        <div class="progress-bar-container">
          <div id="progressBar" class="progress-bar" style="width: 0%;"></div>
        </div>

        <div class="question-area">
          <div class="sentence-display" id="sentenceDisplay">
            Ich wei√ü, <span class="blank">___</span> du recht hast.
          </div>
        </div>

        <div class="button-grid">
          <button class="answer-btn das-btn" onclick="checkAnswer('das')" id="btnDas">
            das
            <span class="key-hint">F</span>
          </button>
          <button class="answer-btn dass-btn" onclick="checkAnswer('dass')" id="btnDass">
            dass
            <span class="key-hint">J</span>
          </button>
        </div>

      </div>

      <div id="resultsArea" class="results hidden">
        <h2>Session Complete!</h2>
        <div class="percentage" id="percentage">100%</div>
        <div class="result-text" id="resultText">
          You got 20 out of 20 correct!
        </div>
        <button class="restart-btn" onclick="startSession()">Practice Again</button>
        <button class="restart-btn secondary" onclick="resetProgress()">Reset All Progress</button>
      </div>
    </div>
  </div>

  <script>
    const SESSION_SIZE = 20;

    const allSentences = [
      // dass - conjunction (50)
      { sentence: "Ich wei√ü, ___ du recht hast.", answer: "dass", id: 1 },
      { sentence: "Er sagt, ___ er morgen kommt.", answer: "dass", id: 2 },
      { sentence: "Sie hofft, ___ alles gut wird.", answer: "dass", id: 3 },
      { sentence: "Ich glaube, ___ es regnen wird.", answer: "dass", id: 4 },
      { sentence: "Es ist wichtig, ___ du p√ºnktlich bist.", answer: "dass", id: 5 },
      { sentence: "Ich freue mich, ___ du da bist.", answer: "dass", id: 6 },
      { sentence: "Er denkt, ___ sie ihn liebt.", answer: "dass", id: 7 },
      { sentence: "Sie wei√ü, ___ er l√ºgt.", answer: "dass", id: 8 },
      { sentence: "Ich bin sicher, ___ du es schaffst.", answer: "dass", id: 9 },
      { sentence: "Es tut mir leid, ___ ich zu sp√§t bin.", answer: "dass", id: 10 },
      { sentence: "Ich verstehe, ___ du m√ºde bist.", answer: "dass", id: 11 },
      { sentence: "Er behauptet, ___ er unschuldig ist.", answer: "dass", id: 12 },
      { sentence: "Sie merkt, ___ etwas nicht stimmt.", answer: "dass", id: 13 },
      { sentence: "Ich habe geh√∂rt, ___ du umziehst.", answer: "dass", id: 14 },
      { sentence: "Es ist schade, ___ du nicht kommen kannst.", answer: "dass", id: 15 },
      { sentence: "Ich finde, ___ es eine gute Idee ist.", answer: "dass", id: 16 },
      { sentence: "Er vergisst, ___ er versprochen hat.", answer: "dass", id: 17 },
      { sentence: "Sie erwartet, ___ du anrufst.", answer: "dass", id: 18 },
      { sentence: "Ich bezweifle, ___ es stimmt.", answer: "dass", id: 19 },
      { sentence: "Es ist klar, ___ wir gehen m√ºssen.", answer: "dass", id: 20 },
      { sentence: "Ich hoffe, ___ du gl√ºcklich bist.", answer: "dass", id: 21 },
      { sentence: "Er bemerkt, ___ sie traurig ist.", answer: "dass", id: 22 },
      { sentence: "Sie bedauert, ___ sie nicht helfen kann.", answer: "dass", id: 23 },
      { sentence: "Ich vermute, ___ er krank ist.", answer: "dass", id: 24 },
      { sentence: "Es ist m√∂glich, ___ er recht hat.", answer: "dass", id: 25 },
      { sentence: "Ich bin froh, ___ alles vorbei ist.", answer: "dass", id: 26 },
      { sentence: "Er betont, ___ er nichts wusste.", answer: "dass", id: 27 },
      { sentence: "Sie best√§tigt, ___ der Termin gilt.", answer: "dass", id: 28 },
      { sentence: "Ich nehme an, ___ du kommst.", answer: "dass", id: 29 },
      { sentence: "Es stimmt, ___ ich es gesagt habe.", answer: "dass", id: 30 },
      { sentence: "Ich erkenne, ___ ich falsch lag.", answer: "dass", id: 31 },
      { sentence: "Er leugnet, ___ er es war.", answer: "dass", id: 32 },
      { sentence: "Sie versichert, ___ alles in Ordnung ist.", answer: "dass", id: 33 },
      { sentence: "Ich f√ºrchte, ___ es zu sp√§t ist.", answer: "dass", id: 34 },
      { sentence: "Es ist bekannt, ___ er reich ist.", answer: "dass", id: 35 },
      { sentence: "Ich w√ºnsche, ___ du gesund bleibst.", answer: "dass", id: 36 },
      { sentence: "Er gibt zu, ___ er gelogen hat.", answer: "dass", id: 37 },
      { sentence: "Sie erz√§hlt, ___ sie ihn getroffen hat.", answer: "dass", id: 38 },
      { sentence: "Ich empfehle, ___ du fr√ºh kommst.", answer: "dass", id: 39 },
      { sentence: "Es bedeutet, ___ wir warten m√ºssen.", answer: "dass", id: 40 },
      { sentence: "Ich schlage vor, ___ wir gehen.", answer: "dass", id: 41 },
      { sentence: "Er beschlie√üt, ___ er bleibt.", answer: "dass", id: 42 },
      { sentence: "Sie verspricht, ___ sie zur√ºckkommt.", answer: "dass", id: 43 },
      { sentence: "Ich bitte darum, ___ du still bist.", answer: "dass", id: 44 },
      { sentence: "Es zeigt, ___ er Talent hat.", answer: "dass", id: 45 },
      { sentence: "Ich verlange, ___ du gehst.", answer: "dass", id: 46 },
      { sentence: "Er fordert, ___ sie antwortet.", answer: "dass", id: 47 },
      { sentence: "Sie besteht darauf, ___ wir bleiben.", answer: "dass", id: 48 },
      { sentence: "Ich warne dich, ___ es gef√§hrlich ist.", answer: "dass", id: 49 },
      { sentence: "Es hei√üt, ___ er morgen abreist.", answer: "dass", id: 50 },
      // das - article/pronoun (50)
      { sentence: "___ Buch liegt auf dem Tisch.", answer: "das", id: 51 },
      { sentence: "___ Kind spielt im Garten.", answer: "das", id: 52 },
      { sentence: "___ Auto ist rot.", answer: "das", id: 53 },
      { sentence: "___ Haus ist sehr alt.", answer: "das", id: 54 },
      { sentence: "Ich lese ___ Buch gerade.", answer: "das", id: 55 },
      { sentence: "___ M√§dchen hei√üt Anna.", answer: "das", id: 56 },
      { sentence: "___ ist eine gute Idee.", answer: "das", id: 57 },
      { sentence: "___ habe ich nicht gewusst.", answer: "das", id: 58 },
      { sentence: "___ stimmt nicht.", answer: "das", id: 59 },
      { sentence: "___ kann ich nicht glauben.", answer: "das", id: 60 },
      { sentence: "___ Wetter ist heute sch√∂n.", answer: "das", id: 61 },
      { sentence: "___ Problem ist schwierig.", answer: "das", id: 62 },
      { sentence: "___ Telefon klingelt.", answer: "das", id: 63 },
      { sentence: "___ Fenster ist offen.", answer: "das", id: 64 },
      { sentence: "___ Kleid gef√§llt mir.", answer: "das", id: 65 },
      { sentence: "___ Foto ist sch√∂n.", answer: "das", id: 66 },
      { sentence: "___ ist der Mann von nebenan.", answer: "das", id: 67 },
      { sentence: "___ Tier war ein Fuchs.", answer: "das", id: 68 },
      { sentence: "___ Ergebnis √ºberrascht mich.", answer: "das", id: 69 },
      { sentence: "___ wei√ü ich schon.", answer: "das", id: 70 },
      { sentence: "___ Leben ist kurz.", answer: "das", id: 71 },
      { sentence: "___ Konzert war fantastisch.", answer: "das", id: 72 },
      { sentence: "___ Restaurant ist teuer.", answer: "das", id: 73 },
      { sentence: "___ Spiel beginnt um acht.", answer: "das", id: 74 },
      { sentence: "___ Wort kenne ich nicht.", answer: "das", id: 75 },
      { sentence: "___ gef√§llt mir nicht.", answer: "das", id: 76 },
      { sentence: "___ muss ich erst pr√ºfen.", answer: "das", id: 77 },
      { sentence: "___ Hotel liegt am Strand.", answer: "das", id: 78 },
      { sentence: "___ Geschenk ist von mir.", answer: "das", id: 79 },
      { sentence: "___ Bild h√§ngt an der Wand.", answer: "das", id: 80 },
      { sentence: "___ Ziel ist klar.", answer: "das", id: 81 },
      { sentence: "___ Projekt ist abgeschlossen.", answer: "das", id: 82 },
      { sentence: "___ Geheimnis bleibt unter uns.", answer: "das", id: 83 },
      { sentence: "___ Thema interessiert mich.", answer: "das", id: 84 },
      { sentence: "___ war ein Fehler.", answer: "das", id: 85 },
      { sentence: "___ Kind ist m√ºde.", answer: "das", id: 86 },
      { sentence: "___ Zimmer ist sauber.", answer: "das", id: 87 },
      { sentence: "___ Wasser ist kalt.", answer: "das", id: 88 },
      { sentence: "___ Radio spielt Musik.", answer: "das", id: 89 },
      { sentence: "___ Museum ist geschlossen.", answer: "das", id: 90 },
      { sentence: "___ Ende naht.", answer: "das", id: 91 },
      { sentence: "___ Angebot ist g√ºnstig.", answer: "das", id: 92 },
      { sentence: "___ Rezept ist einfach.", answer: "das", id: 93 },
      { sentence: "___ Beispiel ist hilfreich.", answer: "das", id: 94 },
      { sentence: "___ hast du gut gemacht.", answer: "das", id: 95 },
      { sentence: "___ verstehe ich nicht.", answer: "das", id: 96 },
      { sentence: "___ Paket ist angekommen.", answer: "das", id: 97 },
      { sentence: "___ Erlebnis war unvergesslich.", answer: "das", id: 98 },
      { sentence: "___ System funktioniert nicht.", answer: "das", id: 99 },
      { sentence: "___ sage ich dir morgen.", answer: "das", id: 100 }
    ];

    let mastered = [];
    let wrong = [];
    let unseen = [];
    let sessionSentences = [];
    let currentIndex = 0;
    let sessionCorrect = 0;
    let answered = false;

    function loadProgress() {
      const saved = localStorage.getItem('das-dass-progress');
      if (saved) {
        const data = JSON.parse(saved);
        mastered = data.mastered || [];
        wrong = data.wrong || [];
      }

      unseen = allSentences
        .map(s => s.id)
        .filter(id => !mastered.includes(id) && !wrong.includes(id));
    }

    function saveProgress() {
      localStorage.setItem('das-dass-progress', JSON.stringify({ mastered, wrong }));
    }

    function shuffle(array) {
      const arr = [...array];
      for (let i = arr.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [arr[i], arr[j]] = [arr[j], arr[i]];
      }
      return arr;
    }

    function selectSessionSentences() {
      loadProgress();

      const wrongSentences = allSentences.filter(s => wrong.includes(s.id));
      const unseenSentences = allSentences.filter(s => unseen.includes(s.id));
      const masteredSentences = allSentences.filter(s => mastered.includes(s.id));

      let selected = [];

      selected.push(...shuffle(wrongSentences).slice(0, Math.min(10, wrongSentences.length)));

      const remaining = SESSION_SIZE - selected.length;
      if (remaining > 0) {
        selected.push(...shuffle(unseenSentences).slice(0, Math.min(remaining, unseenSentences.length)));
      }

      const stillRemaining = SESSION_SIZE - selected.length;
      if (stillRemaining > 0) {
        selected.push(...shuffle(masteredSentences).slice(0, stillRemaining));
      }

      return shuffle(selected);
    }

    function startSession() {
      sessionSentences = selectSessionSentences();
      currentIndex = 0;
      sessionCorrect = 0;

      document.getElementById('exerciseArea').classList.remove('hidden');
      document.getElementById('resultsArea').classList.add('hidden');

      showSentence();
    }

    function showSentence() {
      answered = false;
      const sentence = sessionSentences[currentIndex];

      document.getElementById('currentNum').textContent = currentIndex + 1;
      document.getElementById('masteredCount').textContent = mastered.length;

      const display = sentence.sentence.replace(/_+/g, '<span class="blank">___</span>');
      document.getElementById('sentenceDisplay').innerHTML = display;

      const progress = ((currentIndex) / SESSION_SIZE) * 100;
      document.getElementById('progressBar').style.width = progress + '%';

      document.querySelectorAll('.answer-btn').forEach(btn => {
        btn.disabled = false;
        btn.classList.remove('correct', 'wrong');
      });
    }

    function checkAnswer(selected) {
      if (answered) return;
      answered = true;

      const sentence = sessionSentences[currentIndex];
      const isCorrect = selected === sentence.answer;

      document.querySelectorAll('.answer-btn').forEach(btn => btn.disabled = true);

      const correctBtn = sentence.answer === 'das' ? document.getElementById('btnDas') : document.getElementById('btnDass');
      const selectedBtn = selected === 'das' ? document.getElementById('btnDas') : document.getElementById('btnDass');

      correctBtn.classList.add('correct');
      if (!isCorrect) {
        selectedBtn.classList.add('wrong');
      }

      if (isCorrect) {
        sessionCorrect++;
        if (!mastered.includes(sentence.id)) {
          mastered.push(sentence.id);
          wrong = wrong.filter(id => id !== sentence.id);
          unseen = unseen.filter(id => id !== sentence.id);
        }
      } else {
        if (!wrong.includes(sentence.id)) {
          wrong.push(sentence.id);
          mastered = mastered.filter(id => id !== sentence.id);
          unseen = unseen.filter(id => id !== sentence.id);
        }
      }

      saveProgress();
      document.getElementById('masteredCount').textContent = mastered.length;

      setTimeout(() => {
        if (currentIndex < SESSION_SIZE - 1) {
          currentIndex++;
          showSentence();
        } else {
          showResults();
        }
      }, 1500);
    }

    function showResults() {
      document.getElementById('exerciseArea').classList.add('hidden');
      document.getElementById('resultsArea').classList.remove('hidden');

      const pct = Math.round((sessionCorrect / SESSION_SIZE) * 100);
      document.getElementById('percentage').textContent = pct + '%';
      document.getElementById('resultText').textContent =
        'You got ' + sessionCorrect + ' out of ' + SESSION_SIZE + ' correct!';
    }

    function resetProgress() {
      if (confirm('Reset all progress? This cannot be undone.')) {
        localStorage.removeItem('das-dass-progress');
        mastered = [];
        wrong = [];
        unseen = allSentences.map(s => s.id);
        startSession();
      }
    }

    window.toggleInfo = function() {
      const sec = document.getElementById('infoSection');
      sec.classList.toggle('hidden');
      document.getElementById('toggleBtn').innerHTML = '<u>I</u>nfo';
    };

    window.toggleShortcuts = function() {
      const sec = document.getElementById('shortcutsSection');
      sec.classList.toggle('hidden');
      document.getElementById('shortcutsBtn').innerHTML = '<u>K</u>eys';
    };

    document.addEventListener('keydown', (e) => {
      if (document.getElementById('exerciseArea').classList.contains('hidden')) return;

      const key = e.key.toLowerCase();

      if (key === 'f' && !answered) {
        e.preventDefault();
        checkAnswer('das');
      } else if (key === 'j' && !answered) {
        e.preventDefault();
        checkAnswer('dass');
      } else if (key === 'k') {
        e.preventDefault();
        toggleShortcuts();
      } else if (key === 'i') {
        e.preventDefault();
        toggleInfo();
      }
    });

    loadProgress();
    startSession();
  </script>
</body>
</html>
